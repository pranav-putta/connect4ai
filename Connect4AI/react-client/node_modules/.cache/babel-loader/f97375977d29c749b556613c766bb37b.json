{"ast":null,"code":"import { COLS, ROWS, WIN } from \"./Constants\";\nimport '../Extensions';\nexport let Token;\n\n(function (Token) {\n  Token[Token[\"red\"] = 0] = \"red\";\n  Token[Token[\"yellow\"] = 1] = \"yellow\";\n  Token[Token[\"none\"] = 2] = \"none\";\n})(Token || (Token = {}));\n\nexport let Player;\n\n(function (Player) {\n  Player[Player[\"human\"] = 0] = \"human\";\n  Player[Player[\"ai\"] = 1] = \"ai\";\n})(Player || (Player = {}));\n\nexport function TokenToColor(tok) {\n  switch (tok) {\n    case Token.none:\n      return '#fff';\n\n    case Token.red:\n      return '#ff5252';\n\n    case Token.yellow:\n      return '#ffea00';\n  }\n}\n_c = TokenToColor;\nexport function PlayerToToken(player) {\n  switch (player) {\n    case Player.ai:\n      return Token.red;\n\n    case Player.human:\n      return Token.yellow;\n  }\n}\n_c2 = PlayerToToken;\n\nclass Game {\n  constructor() {\n    this.board = void 0;\n    this.currentPlayer = void 0;\n    this.heights = void 0;\n    let board = [];\n\n    for (let r = 0; r < ROWS; r++) {\n      board.push([]);\n\n      for (let c = 0; c < COLS; c++) {\n        board[r].push(Token.none);\n      }\n    }\n\n    this.board = board;\n    this.currentPlayer = Player.human;\n    this.heights = Array.repeat(0, COLS);\n  }\n\n  get token() {\n    return PlayerToToken(this.currentPlayer);\n  }\n\n  togglePlayer() {\n    if (this.currentPlayer === Player.human) {\n      this.currentPlayer = Player.ai;\n    } else {\n      this.currentPlayer = Player.human;\n    }\n  }\n\n  play(col) {\n    if (col >= COLS) {\n      throw new Error(\"invalid column number\");\n    } else if (this.heights[col] >= COLS - 1) {\n      return false;\n    } // set token\n\n\n    this.board[ROWS - this.heights[col] - 1][col] = this.token; // add to colHeights\n\n    this.heights[col]++; // switch player\n\n    this.togglePlayer();\n    return true;\n  }\n\n  checkWinner() {\n    let tok = this.token;\n\n    for (let r = 0; r < ROWS; r++) {\n      for (let c = 0; c < COLS; c++) {\n        if (r > ROWS - WIN && c > COLS - WIN || this.board[r][c] !== tok) {\n          // no need to check through positions\n          break;\n        }\n\n        let ct = 1; // check right\n\n        for (let i = 1; i < WIN; i++) {\n          if (this.board[r][c + i] !== tok) {\n            break;\n          }\n\n          ct++;\n        }\n\n        if (ct === WIN) {\n          return true;\n        } // check down\n\n\n        ct = 1;\n\n        for (let i = 1; i < WIN; i++) {\n          if (this.board[r + i][c] !== tok) {\n            break;\n          }\n\n          ct++;\n        }\n\n        if (ct === WIN) {\n          return true;\n        } // check r-d diagonal\n\n\n        ct = 1;\n\n        for (let i = 1; i < WIN; i++) {\n          if (this.board[r + i][c + i] !== tok) {\n            break;\n          }\n\n          ct++;\n        }\n\n        if (ct === WIN) {\n          return true;\n        } // check r-u diagonal\n\n\n        if (r >= WIN - 1) {\n          ct = 1;\n\n          for (let i = 1; i < WIN; i++) {\n            if (this.board[r - i][c + i] !== tok) {\n              break;\n            }\n\n            ct++;\n          }\n\n          if (ct === WIN) {\n            return true;\n          }\n        }\n      }\n    }\n\n    return false;\n  }\n\n}\n\nexport default Game;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"TokenToColor\");\n$RefreshReg$(_c2, \"PlayerToToken\");","map":{"version":3,"sources":["/Users/pranavputta/WebstormProjects/Connect4AI/react-client/src/game/Game.ts"],"names":["COLS","ROWS","WIN","Token","Player","TokenToColor","tok","none","red","yellow","PlayerToToken","player","ai","human","Game","constructor","board","currentPlayer","heights","r","push","c","Array","repeat","token","togglePlayer","play","col","Error","checkWinner","ct","i"],"mappings":"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","sourcesContent":["import {COLS, ROWS, WIN} from \"./Constants\";\nimport '../Extensions'\n\nexport enum Token {\n    red, yellow, none\n}\n\nexport enum Player {\n    human, ai\n}\n\nexport function TokenToColor(tok: Token) {\n    switch (tok) {\n        case Token.none:\n            return '#fff'\n        case Token.red:\n            return '#ff5252'\n        case Token.yellow:\n            return '#ffea00'\n    }\n}\n\nexport function PlayerToToken(player: Player) {\n    switch (player) {\n        case Player.ai:\n            return Token.red\n        case Player.human:\n            return Token.yellow\n    }\n}\n\nclass Game {\n\n    public board: Token[][]\n    public currentPlayer: Player\n\n    private heights: number[]\n\n    constructor() {\n        let board: Token[][] = []\n        for (let r = 0; r < ROWS; r++) {\n            board.push([])\n            for (let c = 0; c < COLS; c++) {\n                board[r].push(Token.none)\n            }\n        }\n\n        this.board = board\n        this.currentPlayer = Player.human\n        this.heights = Array.repeat(0, COLS)\n    }\n\n    public get token(): Token {\n        return PlayerToToken(this.currentPlayer)\n    }\n\n    private togglePlayer() {\n        if (this.currentPlayer === Player.human) {\n            this.currentPlayer = Player.ai\n        } else {\n            this.currentPlayer = Player.human\n        }\n    }\n\n    public play(col: number): boolean {\n        if (col >= COLS) {\n            throw new Error(\"invalid column number\")\n        } else if (this.heights[col] >= COLS - 1) {\n            return false;\n        }\n\n        // set token\n        this.board[ROWS - this.heights[col] - 1][col] = this.token\n\n        // add to colHeights\n        this.heights[col]++;\n\n        // switch player\n        this.togglePlayer()\n\n        return true;\n    }\n\n    public checkWinner(): boolean {\n        let tok = this.token\n\n        for (let r = 0; r < ROWS; r++) {\n            for (let c = 0; c < COLS; c++) {\n                if ((r > ROWS - WIN && c > COLS - WIN) || this.board[r][c] !== tok) {\n                    // no need to check through positions\n                    break;\n                }\n                let ct = 1;\n\n                // check right\n                for (let i = 1; i < WIN; i++) {\n                    if (this.board[r][c + i] !== tok) {\n                        break;\n                    }\n                    ct++;\n                }\n\n                if (ct === WIN) {\n                    return true;\n                }\n\n                // check down\n                ct = 1;\n                for (let i = 1; i < WIN; i++) {\n                    if (this.board[r + i][c] !== tok) {\n                        break;\n                    }\n                    ct++;\n                }\n\n                if (ct === WIN) {\n                    return true;\n                }\n\n                // check r-d diagonal\n                ct = 1;\n                for (let i = 1; i < WIN; i++) {\n                    if (this.board[r + i][c + i] !== tok) {\n                        break;\n                    }\n                    ct++;\n                }\n\n                if (ct === WIN) {\n                    return true;\n                }\n\n                // check r-u diagonal\n                if (r >= WIN - 1) {\n                    ct = 1;\n                    for (let i = 1; i < WIN; i++) {\n                        if (this.board[r - i][c + i] !== tok) {\n                            break;\n                        }\n                        ct++;\n                    }\n\n                    if (ct === WIN) {\n                        return true;\n                    }\n                }\n            }\n        }\n        return false;\n    }\n\n}\n\nexport default Game\n"]},"metadata":{},"sourceType":"module"}